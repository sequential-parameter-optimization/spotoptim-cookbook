\contentsline {chapter}{Preface}{1}{chapter*.2}%
\contentsline {part}{\numberline {I}Optimization}{3}{part.1}%
\contentsline {chapter}{\numberline {1}Aircraft Wing Weight Example}{5}{chapter.1}%
\contentsline {section}{\numberline {1.1}AWWE Equation}{5}{section.1.1}%
\contentsline {section}{\numberline {1.2}AWWE Parameters and Equations (Part 1)}{5}{section.1.2}%
\contentsline {section}{\numberline {1.3}Goals: Understanding and Optimization}{6}{section.1.3}%
\contentsline {section}{\numberline {1.4}Properties of the Python ``Solver''}{7}{section.1.4}%
\contentsline {section}{\numberline {1.5}Plot 1: Load Factor (\(N_z\)) and Aspect Ratio (\(A\))}{8}{section.1.5}%
\contentsline {section}{\numberline {1.6}Plot 2: Taper Ratio and Fuel Weight}{11}{section.1.6}%
\contentsline {section}{\numberline {1.7}The Big Picture: Combining all Variables}{12}{section.1.7}%
\contentsline {section}{\numberline {1.8}AWWE Landscape}{15}{section.1.8}%
\contentsline {section}{\numberline {1.9}Summary of the First Experiments}{16}{section.1.9}%
\contentsline {section}{\numberline {1.10}Exercise}{16}{section.1.10}%
\contentsline {subsection}{\numberline {1.10.1}Adding Paint Weight}{16}{subsection.1.10.1}%
\contentsline {section}{\numberline {1.11}Jupyter Notebook}{17}{section.1.11}%
\contentsline {part}{\numberline {II}Numerical Methods}{19}{part.2}%
\contentsline {chapter}{\numberline {2}Simulation and Surrogate Modeling}{21}{chapter.2}%
\contentsline {section}{\numberline {2.1}Surrogates}{21}{section.2.1}%
\contentsline {subsection}{\numberline {2.1.1}Costs of Simulation}{22}{subsection.2.1.1}%
\contentsline {subsection}{\numberline {2.1.2}Mathematical Models and Meta-Models}{22}{subsection.2.1.2}%
\contentsline {subsection}{\numberline {2.1.3}Surrogates = Trained Meta-models}{22}{subsection.2.1.3}%
\contentsline {subsection}{\numberline {2.1.4}Computer Experiments}{22}{subsection.2.1.4}%
\contentsline {subsection}{\numberline {2.1.5}Limits of Mathematical Modeling}{23}{subsection.2.1.5}%
\contentsline {subsection}{\numberline {2.1.6}Why Computer Simulations are Necessary}{23}{subsection.2.1.6}%
\contentsline {subsection}{\numberline {2.1.7}Simulation Requirements}{23}{subsection.2.1.7}%
\contentsline {section}{\numberline {2.2}Applications of Surrogate Models}{23}{section.2.2}%
\contentsline {section}{\numberline {2.3}DACE and RSM}{24}{section.2.3}%
\contentsline {subsection}{\numberline {2.3.1}Noise Handling in RSM and DACE}{25}{subsection.2.3.1}%
\contentsline {section}{\numberline {2.4}Updating a Surrogate Model}{25}{section.2.4}%
\contentsline {chapter}{\numberline {3}Sampling Plans}{27}{chapter.3}%
\contentsline {section}{\numberline {3.1}Ideas and Concepts}{27}{section.3.1}%
\contentsline {subsection}{\numberline {3.1.1}The `Curse of Dimensionality' and How to Avoid It}{29}{subsection.3.1.1}%
\contentsline {subsection}{\numberline {3.1.2}Physical versus Computational Experiments}{29}{subsection.3.1.2}%
\contentsline {subsection}{\numberline {3.1.3}Designing Preliminary Experiments (Screening)}{30}{subsection.3.1.3}%
\contentsline {subsubsection}{\numberline {3.1.3.1}Estimating the Distribution of Elementary Effects}{30}{subsubsection.3.1.3.1}%
\contentsline {subsection}{\numberline {3.1.4}Special Considerations When Deploying Screening Algorithms}{39}{subsection.3.1.4}%
\contentsline {section}{\numberline {3.2}Analyzing Variable Importance in Aircraft Wing Weight}{39}{section.3.2}%
\contentsline {section}{\numberline {3.3}Designing a Sampling Plan}{42}{section.3.3}%
\contentsline {subsection}{\numberline {3.3.1}Stratification}{42}{subsection.3.3.1}%
\contentsline {subsection}{\numberline {3.3.2}Latin Squares and Random Latin Hypercubes}{47}{subsection.3.3.2}%
\contentsline {subsection}{\numberline {3.3.3}Space-filling Designs: Maximin Plans}{50}{subsection.3.3.3}%
\contentsline {subsubsection}{\numberline {3.3.3.1}The Function \texttt {jd}}{52}{subsubsection.3.3.3.1}%
\contentsline {subsection}{\numberline {3.3.4}Memory Management}{55}{subsection.3.3.4}%
\contentsline {subsubsection}{\numberline {3.3.4.1}The Function \texttt {mm}}{55}{subsubsection.3.3.4.1}%
\contentsline {subsubsection}{\numberline {3.3.4.2}The Function \texttt {mmphi}}{58}{subsubsection.3.3.4.2}%
\contentsline {subsubsection}{\numberline {3.3.4.3}The Function \texttt {mmsort}}{60}{subsubsection.3.3.4.3}%
\contentsline {subsubsection}{\numberline {3.3.4.4}The Function \texttt {phisort}}{62}{subsubsection.3.3.4.4}%
\contentsline {subsection}{\numberline {3.3.5}Optimizing the Morris-Mitchell Criterion \(\Phi _q\)}{63}{subsection.3.3.5}%
\contentsline {subsubsection}{\numberline {3.3.5.1}The Function \texttt {perturb()}}{64}{subsubsection.3.3.5.1}%
\contentsline {subsection}{\numberline {3.3.6}Evolutionary Operation}{65}{subsection.3.3.6}%
\contentsline {subsection}{\numberline {3.3.7}Putting it all Together}{66}{subsection.3.3.7}%
\contentsline {subsubsection}{\numberline {3.3.7.1}The Function \texttt {mmlhs}}{66}{subsubsection.3.3.7.1}%
\contentsline {subsubsection}{\numberline {3.3.7.2}The Function \texttt {bestlh}}{69}{subsubsection.3.3.7.2}%
\contentsline {section}{\numberline {3.4}Experimental Analysis of the Morris-Mitchell Criterion}{73}{section.3.4}%
\contentsline {subsection}{\numberline {3.4.1}Evaluation of Sampling Designs}{73}{subsection.3.4.1}%
\contentsline {subsection}{\numberline {3.4.2}Demonstrate the Impact of mmphi Parameters}{77}{subsection.3.4.2}%
\contentsline {subsection}{\numberline {3.4.3}Morris-Mitchell Criterion: Impact of Adding Points}{77}{subsection.3.4.3}%
\contentsline {section}{\numberline {3.5}A Sample-Size Invariant Version of the Morris-Mitchell Criterion}{82}{section.3.5}%
\contentsline {subsection}{\numberline {3.5.1}Comparison of \texttt {mmphi()} and \texttt {mmphi\_intensive()}}{82}{subsection.3.5.1}%
\contentsline {subsection}{\numberline {3.5.2}Plotting the Two Morris-Mitchell Criteria for Different Sample Sizes}{83}{subsection.3.5.2}%
\contentsline {section}{\numberline {3.6}Jupyter Notebook}{86}{section.3.6}%
\contentsline {chapter}{\numberline {4}Constructing a Surrogate}{87}{chapter.4}%
\contentsline {section}{\numberline {4.1}Stage One: Preparing the Data and Choosing a Modelling Approach}{87}{section.4.1}%
\contentsline {section}{\numberline {4.2}Stage Two: Parameter Estimation and Training}{89}{section.4.2}%
\contentsline {section}{\numberline {4.3}Stage Three: Model Testing}{91}{section.4.3}%
\contentsline {section}{\numberline {4.4}Jupyter Notebook}{93}{section.4.4}%
\contentsline {chapter}{\numberline {5}Response Surface Methods}{95}{chapter.5}%
\contentsline {section}{\numberline {5.1}What is RSM?}{95}{section.5.1}%
\contentsline {subsection}{\numberline {5.1.1}Visualization: Problems in Practice}{98}{subsection.5.1.1}%
\contentsline {subsection}{\numberline {5.1.2}RSM: Strategies}{98}{subsection.5.1.2}%
\contentsline {subsection}{\numberline {5.1.3}RSM: Noise in the Empirical Model}{99}{subsection.5.1.3}%
\contentsline {subsection}{\numberline {5.1.4}RSM: Natural and Coded Variables}{99}{subsection.5.1.4}%
\contentsline {subsection}{\numberline {5.1.5}RSM Low-order Polynomials}{100}{subsection.5.1.5}%
\contentsline {section}{\numberline {5.2}First-Order Models (Main Effects Model)}{100}{section.5.2}%
\contentsline {subsection}{\numberline {5.2.1}First-Order Model Properties}{101}{subsection.5.2.1}%
\contentsline {subsection}{\numberline {5.2.2}First-order Model with Interactions in python}{101}{subsection.5.2.2}%
\contentsline {subsection}{\numberline {5.2.3}Observations: First-Order Model with Interactions}{103}{subsection.5.2.3}%
\contentsline {section}{\numberline {5.3}Second-Order Models}{103}{section.5.3}%
\contentsline {subsection}{\numberline {5.3.1}Second-Order Models: Properties}{104}{subsection.5.3.1}%
\contentsline {subsection}{\numberline {5.3.2}Example: Stationary Ridge}{104}{subsection.5.3.2}%
\contentsline {subsection}{\numberline {5.3.3}Observations: Second-Order Model (Ridge)}{105}{subsection.5.3.3}%
\contentsline {subsection}{\numberline {5.3.4}Example: Rising Ridge}{106}{subsection.5.3.4}%
\contentsline {subsection}{\numberline {5.3.5}Summary: Rising Ridge}{107}{subsection.5.3.5}%
\contentsline {subsection}{\numberline {5.3.6}Falling Ridge}{107}{subsection.5.3.6}%
\contentsline {subsection}{\numberline {5.3.7}Saddle Point}{107}{subsection.5.3.7}%
\contentsline {subsection}{\numberline {5.3.8}Interpretation: Saddle Points}{109}{subsection.5.3.8}%
\contentsline {subsection}{\numberline {5.3.9}Summary: Ridge Analysis}{109}{subsection.5.3.9}%
\contentsline {section}{\numberline {5.4}General RSM Models}{109}{section.5.4}%
\contentsline {subsection}{\numberline {5.4.1}Ordinary Least Squares}{109}{subsection.5.4.1}%
\contentsline {section}{\numberline {5.5}General Linear Regression}{110}{section.5.5}%
\contentsline {section}{\numberline {5.6}Designs}{111}{section.5.6}%
\contentsline {subsection}{\numberline {5.6.1}Different Designs}{112}{subsection.5.6.1}%
\contentsline {section}{\numberline {5.7}RSM Experimentation}{112}{section.5.7}%
\contentsline {subsection}{\numberline {5.7.1}First Step}{112}{subsection.5.7.1}%
\contentsline {subsection}{\numberline {5.7.2}Second Step}{112}{subsection.5.7.2}%
\contentsline {subsection}{\numberline {5.7.3}Third Step}{112}{subsection.5.7.3}%
\contentsline {section}{\numberline {5.8}RSM: Review and General Considerations}{113}{section.5.8}%
\contentsline {subsection}{\numberline {5.8.1}Historical Considerations about RSM}{114}{subsection.5.8.1}%
\contentsline {subsection}{\numberline {5.8.2}Status Quo}{114}{subsection.5.8.2}%
\contentsline {subsection}{\numberline {5.8.3}The Role of Statistics}{114}{subsection.5.8.3}%
\contentsline {subsection}{\numberline {5.8.4}New RSM is needed: DACE}{114}{subsection.5.8.4}%
\contentsline {section}{\numberline {5.9}Exercises}{115}{section.5.9}%
\contentsline {section}{\numberline {5.10}Jupyter Notebook}{115}{section.5.10}%
\contentsline {chapter}{\numberline {6}Polynomial Models}{117}{chapter.6}%
\contentsline {section}{\numberline {6.1}Fitting a Polynomial}{117}{section.6.1}%
\contentsline {section}{\numberline {6.2}Polynomial Fitting in Python}{118}{section.6.2}%
\contentsline {subsection}{\numberline {6.2.1}Fitting the Polynomial}{118}{subsection.6.2.1}%
\contentsline {subsection}{\numberline {6.2.2}Explaining the \(k\)-fold Cross-Validation}{119}{subsection.6.2.2}%
\contentsline {subsection}{\numberline {6.2.3}Making Predictions}{120}{subsection.6.2.3}%
\contentsline {subsection}{\numberline {6.2.4}Plotting the Results}{121}{subsection.6.2.4}%
\contentsline {section}{\numberline {6.3}Example One: Aerofoil Drag}{122}{section.6.3}%
\contentsline {section}{\numberline {6.4}Example Two: A Multimodal Test Case}{124}{section.6.4}%
\contentsline {section}{\numberline {6.5}Extending to Multivariable Polynomial Models}{125}{section.6.5}%
\contentsline {section}{\numberline {6.6}Jupyter Notebook}{127}{section.6.6}%
\contentsline {chapter}{\numberline {7}Radial Basis Function Models}{129}{chapter.7}%
\contentsline {section}{\numberline {7.1}Radial Basis Function Models}{129}{section.7.1}%
\contentsline {subsection}{\numberline {7.1.1}Fitting Noise-Free Data}{130}{subsection.7.1.1}%
\contentsline {subsubsection}{\numberline {7.1.1.1}Selecting Basis Functions: From Fixed to Parametric Forms}{131}{subsubsection.7.1.1.1}%
\contentsline {subsubsection}{\numberline {7.1.1.2}The Interpolation Condition: Elegant Solutions Through Linear Systems}{132}{subsubsection.7.1.1.2}%
\contentsline {subsection}{\numberline {7.1.2}Numerical Stability Through Positive Definite Matrices}{134}{subsection.7.1.2}%
\contentsline {subsection}{\numberline {7.1.3}Ill-Conditioning}{135}{subsection.7.1.3}%
\contentsline {subsection}{\numberline {7.1.4}Parameter Optimization: A Two-Level Approach}{136}{subsection.7.1.4}%
\contentsline {subsubsection}{\numberline {7.1.4.1}Inner Level (\(\vec {w}\))}{136}{subsubsection.7.1.4.1}%
\contentsline {subsubsection}{\numberline {7.1.4.2}Outer Level (\(\sigma \))}{137}{subsubsection.7.1.4.2}%
\contentsline {section}{\numberline {7.2}Python Implementation of the RBF Model}{139}{section.7.2}%
\contentsline {subsection}{\numberline {7.2.1}The Rbf Class}{140}{subsection.7.2.1}%
\contentsline {section}{\numberline {7.3}RBF Example: The One-Dimensional \texttt {sin} Function}{146}{section.7.3}%
\contentsline {section}{\numberline {7.4}RBF Example: The Two-Diemnsional \texttt {dome} Function}{148}{section.7.4}%
\contentsline {subsection}{\numberline {7.4.1}The Connection Between RBF Models and Neural Networks}{151}{subsection.7.4.1}%
\contentsline {section}{\numberline {7.5}Radial Basis Function Models for Noisy Data}{152}{section.7.5}%
\contentsline {subsection}{\numberline {7.5.1}Ridge Regularization Approach}{152}{subsection.7.5.1}%
\contentsline {subsection}{\numberline {7.5.2}Reduced Basis Approach}{152}{subsection.7.5.2}%
\contentsline {section}{\numberline {7.6}Jupyter Notebook}{153}{section.7.6}%
\contentsline {chapter}{\numberline {8}Kriging (Gaussian Process Regression)}{155}{chapter.8}%
\contentsline {section}{\numberline {8.1}From Gaussian RBF to Kriging Basis Functions}{155}{section.8.1}%
\contentsline {section}{\numberline {8.2}Building the Kriging Model}{156}{section.8.2}%
\contentsline {section}{\numberline {8.3}MLE to estimate \(\theta \) and \(p\)}{163}{section.8.3}%
\contentsline {subsection}{\numberline {8.3.1}The Log-Likelihood}{163}{subsection.8.3.1}%
\contentsline {subsection}{\numberline {8.3.2}Differentiation with Respect to \(\mu \)}{165}{subsection.8.3.2}%
\contentsline {subsection}{\numberline {8.3.3}Differentiation with Respect to \(\sigma \)}{167}{subsection.8.3.3}%
\contentsline {subsection}{\numberline {8.3.4}Results of the Optimizations}{167}{subsection.8.3.4}%
\contentsline {subsection}{\numberline {8.3.5}The Concentrated Log-Likelihood Function}{168}{subsection.8.3.5}%
\contentsline {subsection}{\numberline {8.3.6}Optimizing the Parameters \(\vec {\theta }\) and \(\vec {p}\)}{168}{subsection.8.3.6}%
\contentsline {subsection}{\numberline {8.3.7}Correlation and Covariance Matrices Revisited}{168}{subsection.8.3.7}%
\contentsline {section}{\numberline {8.4}Implementing an MLE of the Model Parameters}{169}{section.8.4}%
\contentsline {section}{\numberline {8.5}Kriging Prediction}{170}{section.8.5}%
\contentsline {section}{\numberline {8.6}Kriging Example: Sinusoid Function}{171}{section.8.6}%
\contentsline {subsection}{\numberline {8.6.1}Calculating the Correlation Matrix \(\Psi \)}{171}{subsection.8.6.1}%
\contentsline {subsection}{\numberline {8.6.2}Computing the \(\Psi \) Matrix}{173}{subsection.8.6.2}%
\contentsline {subsection}{\numberline {8.6.3}Selecting the New Locations}{174}{subsection.8.6.3}%
\contentsline {subsection}{\numberline {8.6.4}Computing the \(\psi \) Vector}{174}{subsection.8.6.4}%
\contentsline {subsection}{\numberline {8.6.5}Predicting at New Locations}{175}{subsection.8.6.5}%
\contentsline {subsection}{\numberline {8.6.6}Visualization}{175}{subsection.8.6.6}%
\contentsline {subsection}{\numberline {8.6.7}The Complete Python Code for the Example}{176}{subsection.8.6.7}%
\contentsline {section}{\numberline {8.7}Jupyter Notebook}{182}{section.8.7}%
\contentsline {chapter}{\numberline {9}Matrices}{183}{chapter.9}%
\contentsline {section}{\numberline {9.1}Derivatives of Quadratic Forms}{183}{section.9.1}%
\contentsline {section}{\numberline {9.2}The Condition Number}{184}{section.9.2}%
\contentsline {section}{\numberline {9.3}The Moore-Penrose Pseudoinverse}{185}{section.9.3}%
\contentsline {subsection}{\numberline {9.3.1}Definitions}{185}{subsection.9.3.1}%
\contentsline {subsection}{\numberline {9.3.2}Implementation in Python}{185}{subsection.9.3.2}%
\contentsline {section}{\numberline {9.4}Strictly Positive Definite Kernels}{186}{section.9.4}%
\contentsline {subsection}{\numberline {9.4.1}Definition}{186}{subsection.9.4.1}%
\contentsline {subsection}{\numberline {9.4.2}Connection to Positive Definite Matrices}{186}{subsection.9.4.2}%
\contentsline {subsection}{\numberline {9.4.3}Connection to RBF Models}{187}{subsection.9.4.3}%
\contentsline {section}{\numberline {9.5}Cholesky Decomposition and Positive Definite Matrices}{187}{section.9.5}%
\contentsline {subsection}{\numberline {9.5.1}Example of Cholesky Decomposition}{190}{subsection.9.5.1}%
\contentsline {subsection}{\numberline {9.5.2}Inverse Matrix Using Cholesky Decomposition}{191}{subsection.9.5.2}%
\contentsline {section}{\numberline {9.6}Nyström Approximation}{192}{section.9.6}%
\contentsline {subsection}{\numberline {9.6.1}What's the Big Idea?}{192}{subsection.9.6.1}%
\contentsline {subsection}{\numberline {9.6.2}How Does It Work?}{192}{subsection.9.6.2}%
\contentsline {subsection}{\numberline {9.6.3}Example}{193}{subsection.9.6.3}%
\contentsline {subsection}{\numberline {9.6.4}Why Is This Useful?}{193}{subsection.9.6.4}%
\contentsline {subsection}{\numberline {9.6.5}Applying the Nyström Approximation: How Nyström Approximation Helps Kriging}{194}{subsection.9.6.5}%
\contentsline {subsection}{\numberline {9.6.6}Example: Predicting Temperature with Nyström-Kriging}{194}{subsection.9.6.6}%
\contentsline {subsubsection}{\numberline {9.6.6.1}Step 1: Nyström Approximation of the Covariance Matrix}{195}{subsubsection.9.6.6.1}%
\contentsline {subsubsection}{\numberline {9.6.6.2}Step 2: Modeling and Prediction}{195}{subsubsection.9.6.6.2}%
\contentsline {subsection}{\numberline {9.6.7}Details: Woodbury Matrix Identity for Avoiding the Big Inversion}{195}{subsection.9.6.7}%
\contentsline {subsection}{\numberline {9.6.8}The Example: Step-by-Step}{196}{subsection.9.6.8}%
\contentsline {subsubsection}{\numberline {9.6.8.1}Method 1: The Slow Way (Forming the full matrix)}{197}{subsubsection.9.6.8.1}%
\contentsline {subsubsection}{\numberline {9.6.8.2}Method 2: The Fast Way (Using Woodbury Identity)}{197}{subsubsection.9.6.8.2}%
\contentsline {section}{\numberline {9.7}Extending spotpython's Kriging Surrogate with Nyström Approximation for Enhanced Scalability}{198}{section.9.7}%
\contentsline {subsection}{\numberline {9.7.1}Introduction: Overcoming the Scalability Challenge in Kriging for Sequential Optimization}{198}{subsection.9.7.1}%
\contentsline {subsection}{\numberline {9.7.2}Report Objectives and Structure}{199}{subsection.9.7.2}%
\contentsline {section}{\numberline {9.8}Theoretical Foundations: The Nyström--Kriging Framework}{199}{section.9.8}%
\contentsline {subsection}{\numberline {9.8.1}A Primer on Kriging (Gaussian Process Regression)}{199}{subsection.9.8.1}%
\contentsline {subsection}{\numberline {9.8.2}The Nyström Method for Low-Rank Kernel Approximation}{199}{subsection.9.8.2}%
\contentsline {subsection}{\numberline {9.8.3}Justification for Landmark Selection}{200}{subsection.9.8.3}%
\contentsline {section}{\numberline {9.9}Implementation: A Scalable Kriging Class for spotpython}{200}{section.9.9}%
\contentsline {subsection}{\numberline {9.9.1}Updated kriging.py with Nyström Approximation (excerpt)}{200}{subsection.9.9.1}%
\contentsline {section}{\numberline {9.10}Implementation Details}{202}{section.9.10}%
\contentsline {subsection}{\numberline {9.10.1}Architectural Enhancements to \texttt {init}}{202}{subsection.9.10.1}%
\contentsline {subsection}{\numberline {9.10.2}The \texttt {fit()} Method: A Dual-Pathway Approach}{203}{subsection.9.10.2}%
\contentsline {subsection}{\numberline {9.10.3}The \texttt {predict()} Method: Conditional Prediction Logic}{203}{subsection.9.10.3}%
\contentsline {subsection}{\numberline {9.10.4}Critical Detail: Preserving Mixed Variable Type Functionality}{203}{subsection.9.10.4}%
\contentsline {subsection}{\numberline {9.10.5}Seamless Integration into the Nyström Workflow}{204}{subsection.9.10.5}%
\contentsline {section}{\numberline {9.11}Jupyter Notebook}{204}{section.9.11}%
\contentsline {chapter}{\numberline {10}Infill Criteria}{205}{chapter.10}%
\contentsline {section}{\numberline {10.1}Balancing Exploitation and Exploration}{206}{section.10.1}%
\contentsline {section}{\numberline {10.2}Expected Improvement (EI)}{206}{section.10.2}%
\contentsline {section}{\numberline {10.3}Expected Improvement in the Hyperparameter Tuning Cookbook (Python Implementation)}{207}{section.10.3}%
\contentsline {section}{\numberline {10.4}Jupyter Notebook}{208}{section.10.4}%
\contentsline {part}{\numberline {III}Sequential Parameter Optimization Toolbox (SPOT)}{209}{part.3}%
\contentsline {chapter}{\numberline {11}SpotOptim Step-by-Step Optimization Process}{211}{chapter.11}%
\contentsline {chapter}{\numberline {12}Introduction}{213}{chapter.12}%
\contentsline {chapter}{\numberline {13}Setup and Test Functions}{215}{chapter.13}%
\contentsline {chapter}{\numberline {14}Standard Optimization Workflow}{217}{chapter.14}%
\contentsline {section}{\numberline {14.1}Phase: Initialization and Setup}{217}{section.14.1}%
\contentsline {section}{\numberline {14.2}Phase: Initial Design Generation}{218}{section.14.2}%
\contentsline {subsection}{\numberline {14.2.1}Method: \texttt {get\_initial\_design()}}{218}{subsection.14.2.1}%
\contentsline {section}{\numberline {14.3}Phase 3: Initial Design Curation}{221}{section.14.3}%
\contentsline {subsection}{\numberline {14.3.1}Method: \texttt {\_curate\_initial\_design()}}{221}{subsection.14.3.1}%
\contentsline {section}{\numberline {14.4}Phase 4: Initial Design Evaluation}{221}{section.14.4}%
\contentsline {subsection}{\numberline {14.4.1}Method: \texttt {\_evaluate\_function()}}{221}{subsection.14.4.1}%
\contentsline {section}{\numberline {14.5}Phase 5: Handling Failed Evaluations}{222}{section.14.5}%
\contentsline {subsection}{\numberline {14.5.1}Method: \texttt {\_handle\_NA\_initial\_design(X0,y0)}}{222}{subsection.14.5.1}%
\contentsline {section}{\numberline {14.6}Phase 6: Validation Check}{223}{section.14.6}%
\contentsline {subsection}{\numberline {14.6.1}Method: \texttt {\_check\_size\_initial\_design(y0,\ n\_evaluated)}}{223}{subsection.14.6.1}%
\contentsline {section}{\numberline {14.7}Phase 7: Storage Initialization}{223}{section.14.7}%
\contentsline {subsection}{\numberline {14.7.1}Method: \texttt {\_init\_storage()}}{223}{subsection.14.7.1}%
\contentsline {section}{\numberline {14.8}Phase: Statistics Update}{224}{section.14.8}%
\contentsline {subsection}{\numberline {14.8.1}Method: \texttt {update\_stats()}}{224}{subsection.14.8.1}%
\contentsline {section}{\numberline {14.9}Phase: Log initial Design to TensorBoard}{224}{section.14.9}%
\contentsline {subsection}{\numberline {14.9.1}Method: \texttt {\_log\_initial\_design\_tensorboard()}}{224}{subsection.14.9.1}%
\contentsline {section}{\numberline {14.10}Phase: Initial Best Point}{225}{section.14.10}%
\contentsline {subsection}{\numberline {14.10.1}Method: \texttt {\_get\_best\_xy\_initial\_design()}}{225}{subsection.14.10.1}%
\contentsline {section}{\numberline {14.11}Illustration of the Initial Design Phase Results}{225}{section.14.11}%
\contentsline {chapter}{\numberline {15}Sequential Optimization Loop}{227}{chapter.15}%
\contentsline {section}{\numberline {15.1}Step: Surrogate Model Fitting}{227}{section.15.1}%
\contentsline {subsection}{\numberline {15.1.1}Method: \texttt {\_fit\_scheduler()}}{227}{subsection.15.1.1}%
\contentsline {subsection}{\numberline {15.1.2}Method: \texttt {\_fit\_surrogate()}}{227}{subsection.15.1.2}%
\contentsline {subsection}{\numberline {15.1.3}Method: \texttt {\_selection\_dispatcher()}}{228}{subsection.15.1.3}%
\contentsline {subsection}{\numberline {15.1.4}Step: Apply OCBA}{229}{subsection.15.1.4}%
\contentsline {subsection}{\numberline {15.1.5}Method: \texttt {\_apply\_ocba()}}{229}{subsection.15.1.5}%
\contentsline {section}{\numberline {15.2}Step: Predict with Uncertainty}{230}{section.15.2}%
\contentsline {subsection}{\numberline {15.2.1}Method: \texttt {\_predict\_with\_uncertainty()}}{230}{subsection.15.2.1}%
\contentsline {section}{\numberline {15.3}Step: Next Point Suggestion}{230}{section.15.3}%
\contentsline {subsection}{\numberline {15.3.1}Method: \texttt {\_suggest\_next\_point()}}{230}{subsection.15.3.1}%
\contentsline {section}{\numberline {15.4}Step: Acquisition Function Evaluation}{231}{section.15.4}%
\contentsline {subsection}{\numberline {15.4.1}Method: \texttt {\_acquisition\_function()}}{231}{subsection.15.4.1}%
\contentsline {section}{\numberline {15.5}Step: Update Repeats for Infill Points}{232}{section.15.5}%
\contentsline {subsection}{\numberline {15.5.1}Method: \texttt {\_update\_repeats\_infill\_points()}}{232}{subsection.15.5.1}%
\contentsline {section}{\numberline {15.6}Append OCBA Points to Infill Points}{233}{section.15.6}%
\contentsline {section}{\numberline {15.7}Step: Evaluation of New Points}{233}{section.15.7}%
\contentsline {subsection}{\numberline {15.7.1}Method: \texttt {\_evaluate\_function()} (again)}{233}{subsection.15.7.1}%
\contentsline {section}{\numberline {15.8}Step: Handle Failed Evaluations (Sequential)}{233}{section.15.8}%
\contentsline {subsection}{\numberline {15.8.1}Method: \texttt {\_handle\_NA\_new\_points()}}{233}{subsection.15.8.1}%
\contentsline {section}{\numberline {15.9}Step: Update Success Rate}{234}{section.15.9}%
\contentsline {subsection}{\numberline {15.9.1}Method: \texttt {\_update\_success\_rate(y0)}}{234}{subsection.15.9.1}%
\contentsline {section}{\numberline {15.10}Step: Update Storage}{235}{section.15.10}%
\contentsline {subsection}{\numberline {15.10.1}Internal updates}{235}{subsection.15.10.1}%
\contentsline {section}{\numberline {15.11}Update Statistics}{235}{section.15.11}%
\contentsline {subsection}{\numberline {15.11.1}What happens in \texttt {update\_stats()}:}{235}{subsection.15.11.1}%
\contentsline {section}{\numberline {15.12}Step: Update Best Solution}{236}{section.15.12}%
\contentsline {subsection}{\numberline {15.12.1}Method: \texttt {\_update\_best\_main\_loop()}}{236}{subsection.15.12.1}%
\contentsline {chapter}{\numberline {16}Complete Optimization Example}{237}{chapter.16}%
\contentsline {chapter}{\numberline {17}Noisy Functions with Repeats}{239}{chapter.17}%
\contentsline {section}{\numberline {17.1}Configuration for Noisy Functions}{239}{section.17.1}%
\contentsline {section}{\numberline {17.2}Noisy Optimization Workflow Differences}{240}{section.17.2}%
\contentsline {subsection}{\numberline {17.2.1}Modified Initial Design}{240}{subsection.17.2.1}%
\contentsline {subsection}{\numberline {17.2.2}Update Statistics Method}{241}{subsection.17.2.2}%
\contentsline {chapter}{\numberline {18}Optimal Computing Budget Allocation (OCBA)}{243}{chapter.18}%
\contentsline {section}{\numberline {18.1}OCBA Configuration}{243}{section.18.1}%
\contentsline {section}{\numberline {18.2}OCBA Method}{244}{section.18.2}%
\contentsline {subsection}{\numberline {18.2.1}Method: \texttt {\_apply\_ocba()}}{244}{subsection.18.2.1}%
\contentsline {chapter}{\numberline {19}Handling Function Evaluation Failures}{247}{chapter.19}%
\contentsline {section}{\numberline {19.1}Example with Failures}{247}{section.19.1}%
\contentsline {section}{\numberline {19.2}Failure Handling in Initial Design}{248}{section.19.2}%
\contentsline {subsection}{\numberline {19.2.1}Method: \texttt {\_handle\_NA\_initial\_design()}}{248}{subsection.19.2.1}%
\contentsline {section}{\numberline {19.3}Failure Handling in Sequential Phase}{249}{section.19.3}%
\contentsline {subsection}{\numberline {19.3.1}Method: \texttt {\_handle\_NA\_new\_points()}}{249}{subsection.19.3.1}%
\contentsline {section}{\numberline {19.4}Penalty Application}{249}{section.19.4}%
\contentsline {subsection}{\numberline {19.4.1}Method: \texttt {\_apply\_penalty\_NA()}}{249}{subsection.19.4.1}%
\contentsline {chapter}{\numberline {20}Complete Method Summary}{251}{chapter.20}%
\contentsline {section}{\numberline {20.1}Methods Called During \texttt {optimize()}}{251}{section.20.1}%
\contentsline {subsection}{\numberline {20.1.1}Preparation Phase}{251}{subsection.20.1.1}%
\contentsline {subsection}{\numberline {20.1.2}Sequential Optimization Loop (each iteration)}{251}{subsection.20.1.2}%
\contentsline {subsection}{\numberline {20.1.3}Finalization}{252}{subsection.20.1.3}%
\contentsline {section}{\numberline {20.2}Helper Methods Used}{252}{section.20.2}%
\contentsline {chapter}{\numberline {21}Termination Conditions}{253}{chapter.21}%
\contentsline {section}{\numberline {21.1}Method: \texttt {\_determine\_termination()}}{253}{section.21.1}%
\contentsline {chapter}{\numberline {22}Performance Comparison on Noisy Functions}{255}{chapter.22}%
\contentsline {chapter}{\numberline {23}Summary}{259}{chapter.23}%
\contentsline {section}{\numberline {23.1}Complete Workflow Diagram}{259}{section.23.1}%
\contentsline {section}{\numberline {23.2}Key Concepts}{261}{section.23.2}%
\contentsline {subsection}{\numberline {23.2.1}1. Initial Design}{261}{subsection.23.2.1}%
\contentsline {subsection}{\numberline {23.2.2}2. Surrogate Model}{261}{subsection.23.2.2}%
\contentsline {subsection}{\numberline {23.2.3}3. Acquisition Function}{261}{subsection.23.2.3}%
\contentsline {subsection}{\numberline {23.2.4}4. Noise Handling}{261}{subsection.23.2.4}%
\contentsline {subsection}{\numberline {23.2.5}5. Failure Handling}{262}{subsection.23.2.5}%
\contentsline {section}{\numberline {23.3}Best Practices}{262}{section.23.3}%
\contentsline {section}{\numberline {23.4}Conclusion}{262}{section.23.4}%
\contentsline {chapter}{\numberline {24}SpotOptim Internal Methods Examples}{263}{chapter.24}%
\contentsline {section}{\numberline {24.1}Setup: Import Required Packages}{263}{section.24.1}%
\contentsline {section}{\numberline {24.2}1. Main Optimization Method: \texttt {optimize()}}{263}{section.24.2}%
\contentsline {section}{\numberline {24.3}2. Initial Design Methods}{265}{section.24.3}%
\contentsline {subsection}{\numberline {24.3.1}2.1 \texttt {get\_initial\_design()}}{265}{subsection.24.3.1}%
\contentsline {subsection}{\numberline {24.3.2}2.2 \texttt {\_curate\_initial\_design()}}{266}{subsection.24.3.2}%
\contentsline {subsection}{\numberline {24.3.3}2.3 \texttt {\_handle\_NA\_initial\_design()}}{267}{subsection.24.3.3}%
\contentsline {subsection}{\numberline {24.3.4}2.4 \texttt {\_check\_size\_initial\_design()}}{268}{subsection.24.3.4}%
\contentsline {subsection}{\numberline {24.3.5}2.5 \texttt {\_get\_best\_xy\_initial\_design()}}{268}{subsection.24.3.5}%
\contentsline {section}{\numberline {24.4}3. Surrogate Model Methods}{269}{section.24.4}%
\contentsline {subsection}{\numberline {24.4.1}3.1 \texttt {\_fit\_surrogate()}}{269}{subsection.24.4.1}%
\contentsline {subsection}{\numberline {24.4.2}3.2 \texttt {\_predict\_with\_uncertainty()}}{270}{subsection.24.4.2}%
\contentsline {subsection}{\numberline {24.4.3}3.3 \texttt {\_acquisition\_function()}}{270}{subsection.24.4.3}%
\contentsline {subsection}{\numberline {24.4.4}3.4 \texttt {\_suggest\_next\_point()}}{271}{subsection.24.4.4}%
\contentsline {section}{\numberline {24.5}4. OCBA Method (Optimal Computing Budget Allocation)}{272}{section.24.5}%
\contentsline {subsection}{\numberline {24.5.1}4.1 \texttt {\_apply\_ocba()}}{272}{subsection.24.5.1}%
\contentsline {section}{\numberline {24.6}5. NaN/Inf Handling Methods}{273}{section.24.6}%
\contentsline {subsection}{\numberline {24.6.1}5.1 \texttt {\_apply\_penalty\_NA()}}{273}{subsection.24.6.1}%
\contentsline {subsection}{\numberline {24.6.2}5.2 \texttt {\_remove\_nan()}}{274}{subsection.24.6.2}%
\contentsline {subsection}{\numberline {24.6.3}5.3 \texttt {\_handle\_NA\_new\_points()}}{274}{subsection.24.6.3}%
\contentsline {section}{\numberline {24.7}6. Main Loop Update Methods}{275}{section.24.7}%
\contentsline {subsection}{\numberline {24.7.1}6.1 \texttt {\_update\_best\_main\_loop()}}{275}{subsection.24.7.1}%
\contentsline {section}{\numberline {24.8}7. Termination Method}{276}{section.24.8}%
\contentsline {subsection}{\numberline {24.8.1}7.1 \texttt {\_determine\_termination()}}{276}{subsection.24.8.1}%
\contentsline {section}{\numberline {24.9}8. Utility Methods}{278}{section.24.9}%
\contentsline {subsection}{\numberline {24.9.1}8.1 \texttt {\_select\_new()}}{278}{subsection.24.9.1}%
\contentsline {subsection}{\numberline {24.9.2}8.2 \texttt {\_repair\_non\_numeric()}}{278}{subsection.24.9.2}%
\contentsline {subsection}{\numberline {24.9.3}8.3 \texttt {\_map\_to\_factor\_values()}}{279}{subsection.24.9.3}%
\contentsline {section}{\numberline {24.10}9. Integration Examples}{280}{section.24.10}%
\contentsline {subsection}{\numberline {24.10.1}9.1 Optimization with Custom Initial Design}{280}{subsection.24.10.1}%
\contentsline {subsection}{\numberline {24.10.2}9.2 Optimization with Starting Point}{281}{subsection.24.10.2}%
\contentsline {subsection}{\numberline {24.10.3}9.3 Optimization with Integer Variables}{282}{subsection.24.10.3}%
\contentsline {subsection}{\numberline {24.10.4}9.4 Noisy Function Optimization with OCBA}{283}{subsection.24.10.4}%
\contentsline {subsection}{\numberline {24.10.5}9.5 Optimization with NaN Handling}{284}{subsection.24.10.5}%
\contentsline {section}{\numberline {24.11}10. Method Relationship Diagram}{285}{section.24.11}%
\contentsline {section}{\numberline {24.12}11. Summary}{286}{section.24.12}%
\contentsline {chapter}{\numberline {25}Benchmarking SpotOptim with Sklearn Kriging (Matern Kernel) on 6D Rosenbrock and 10D Michalewicz Functions}{287}{chapter.25}%
\contentsline {section}{\numberline {25.1}SpotOptim with Sklearn Kriging in 6 Dimensions: Rosenbrock Function}{287}{section.25.1}%
\contentsline {subsection}{\numberline {25.1.1}Define the 6D Rosenbrock Function}{287}{subsection.25.1.1}%
\contentsline {subsection}{\numberline {25.1.2}Set up SpotOptim Parameters}{288}{subsection.25.1.2}%
\contentsline {subsection}{\numberline {25.1.3}Sklearn Gaussian Process Regressor as Surrogate}{288}{subsection.25.1.3}%
\contentsline {subsection}{\numberline {25.1.4}Visualize Optimization Progress}{291}{subsection.25.1.4}%
\contentsline {subsection}{\numberline {25.1.5}Evaluation of Multiple Repeats}{291}{subsection.25.1.5}%
\contentsline {section}{\numberline {25.2}SpotOptim with Sklearn Kriging in 10 Dimensions: Michalewicz Function}{293}{section.25.2}%
\contentsline {subsection}{\numberline {25.2.1}Define the 10D Michalewicz Function}{293}{subsection.25.2.1}%
\contentsline {subsection}{\numberline {25.2.2}Set up SpotOptim Parameters}{293}{subsection.25.2.2}%
\contentsline {subsection}{\numberline {25.2.3}Sklearn Gaussian Process Regressor as Surrogate}{293}{subsection.25.2.3}%
\contentsline {subsection}{\numberline {25.2.4}Visualize Optimization Progress}{301}{subsection.25.2.4}%
\contentsline {subsection}{\numberline {25.2.5}Evaluation of Multiple Repeats}{301}{subsection.25.2.5}%
\contentsline {section}{\numberline {25.3}Comparison: SpotOptim vs SpotPython}{302}{section.25.3}%
\contentsline {section}{\numberline {25.4}Summary}{303}{section.25.4}%
\contentsline {section}{\numberline {25.5}Jupyter Notebook}{303}{section.25.5}%
\contentsline {chapter}{\numberline {26}Kriging Surrogate Models in SpotOptim}{305}{chapter.26}%
\contentsline {section}{\numberline {26.1}Introduction}{305}{section.26.1}%
\contentsline {subsection}{\numberline {26.1.1}What is Kriging?}{305}{subsection.26.1.1}%
\contentsline {subsection}{\numberline {26.1.2}Why Use Kriging in SpotOptim?}{306}{subsection.26.1.2}%
\contentsline {section}{\numberline {26.2}Basic Usage}{306}{section.26.2}%
\contentsline {subsection}{\numberline {26.2.1}Creating a Simple Kriging Model}{306}{subsection.26.2.1}%
\contentsline {subsection}{\numberline {26.2.2}Default vs Custom Surrogate}{307}{subsection.26.2.2}%
\contentsline {section}{\numberline {26.3}Understanding Kriging Parameters}{308}{section.26.3}%
\contentsline {subsection}{\numberline {26.3.1}Method: Interpolation vs Regression}{308}{subsection.26.3.1}%
\contentsline {subsection}{\numberline {26.3.2}Noise Parameter and Regularization}{310}{subsection.26.3.2}%
\contentsline {subsection}{\numberline {26.3.3}Correlation Length Parameters (Theta)}{311}{subsection.26.3.3}%
\contentsline {subsection}{\numberline {26.3.4}Isotropic vs Anisotropic Correlation}{312}{subsection.26.3.4}%
\contentsline {section}{\numberline {26.4}Advanced Features}{313}{section.26.4}%
\contentsline {subsection}{\numberline {26.4.1}Mixed Variable Types}{313}{subsection.26.4.1}%
\contentsline {subsection}{\numberline {26.4.2}Customizing the Distance Metric for Factors}{316}{subsection.26.4.2}%
\contentsline {subsection}{\numberline {26.4.3}Handling High-Dimensional Problems}{317}{subsection.26.4.3}%
\contentsline {subsection}{\numberline {26.4.4}Uncertainty Quantification}{318}{subsection.26.4.4}%
\contentsline {section}{\numberline {26.5}Practical Examples}{320}{section.26.5}%
\contentsline {subsection}{\numberline {26.5.1}Example 1: Optimizing the Rastrigin Function}{320}{subsection.26.5.1}%
\contentsline {subsection}{\numberline {26.5.2}Example 2: Robust Optimization with Noise}{322}{subsection.26.5.2}%
\contentsline {subsection}{\numberline {26.5.3}Example 3: Real-World Machine Learning Hyperparameter Tuning}{324}{subsection.26.5.3}%
\contentsline {subsection}{\numberline {26.5.4}Example 4: Comparing Kriging Methods}{326}{subsection.26.5.4}%
\contentsline {subsection}{\numberline {26.5.5}Example 5: Sensitivity to Theta Bounds}{327}{subsection.26.5.5}%
\contentsline {section}{\numberline {26.6}Comparing Surrogates}{329}{section.26.6}%
\contentsline {subsection}{\numberline {26.6.1}Kriging vs Gaussian Process vs Random Forest}{329}{subsection.26.6.1}%
\contentsline {section}{\numberline {26.7}Best Practices}{330}{section.26.7}%
\contentsline {subsection}{\numberline {26.7.1}1. Choosing the Right Method}{330}{subsection.26.7.1}%
\contentsline {subsection}{\numberline {26.7.2}2. Setting Model Complexity}{331}{subsection.26.7.2}%
\contentsline {subsection}{\numberline {26.7.3}3. Handling Different Variable Types}{331}{subsection.26.7.3}%
\contentsline {subsection}{\numberline {26.7.4}4. Reproducibility}{332}{subsection.26.7.4}%
\contentsline {subsection}{\numberline {26.7.5}5. Monitoring Surrogate Quality}{332}{subsection.26.7.5}%
\contentsline {section}{\numberline {26.8}Common Issues and Solutions}{333}{section.26.8}%
\contentsline {subsection}{\numberline {26.8.1}Issue 1: Slow Fitting for Large Datasets}{333}{subsection.26.8.1}%
\contentsline {subsection}{\numberline {26.8.2}Issue 2: Poor Predictions for Categorical Variables}{333}{subsection.26.8.2}%
\contentsline {subsection}{\numberline {26.8.3}Issue 3: Numerical Instability}{334}{subsection.26.8.3}%
\contentsline {subsection}{\numberline {26.8.4}Issue 4: Overfitting to Noisy Data}{334}{subsection.26.8.4}%
\contentsline {section}{\numberline {26.9}Summary}{334}{section.26.9}%
\contentsline {subsection}{\numberline {26.9.1}Key Takeaways}{334}{subsection.26.9.1}%
\contentsline {subsection}{\numberline {26.9.2}Quick Reference}{335}{subsection.26.9.2}%
\contentsline {subsection}{\numberline {26.9.3}Parameter Cheat Sheet}{335}{subsection.26.9.3}%
\contentsline {subsection}{\numberline {26.9.4}Further Reading}{335}{subsection.26.9.4}%
\contentsline {chapter}{\numberline {27}Reproducibility in SpotOptim}{337}{chapter.27}%
\contentsline {section}{\numberline {27.1}Introduction}{337}{section.27.1}%
\contentsline {section}{\numberline {27.2}Basic Usage}{337}{section.27.2}%
\contentsline {subsection}{\numberline {27.2.1}Making Optimization Reproducible}{337}{subsection.27.2.1}%
\contentsline {subsection}{\numberline {27.2.2}Running Independent Experiments}{338}{subsection.27.2.2}%
\contentsline {section}{\numberline {27.3}Practical Examples}{339}{section.27.3}%
\contentsline {subsection}{\numberline {27.3.1}Example 1: Comparing Different Configurations}{339}{subsection.27.3.1}%
\contentsline {subsection}{\numberline {27.3.2}Example 2: Reproducible Research Experiment}{340}{subsection.27.3.2}%
\contentsline {subsection}{\numberline {27.3.3}Example 3: Multiple Independent Runs}{342}{subsection.27.3.3}%
\contentsline {subsection}{\numberline {27.3.4}Example 4: Reproducible Initial Design}{344}{subsection.27.3.4}%
\contentsline {subsection}{\numberline {27.3.5}Example 5: Custom Initial Design with Seed}{345}{subsection.27.3.5}%
\contentsline {section}{\numberline {27.4}Advanced Topics}{346}{section.27.4}%
\contentsline {subsection}{\numberline {27.4.1}Seed and Noisy Functions}{346}{subsection.27.4.1}%
\contentsline {subsection}{\numberline {27.4.2}Different Seeds for Different Exploration}{347}{subsection.27.4.2}%
\contentsline {section}{\numberline {27.5}Best Practices}{348}{section.27.5}%
\contentsline {subsection}{\numberline {27.5.1}1. Always Use Seeds for Production Code}{348}{subsection.27.5.1}%
\contentsline {subsection}{\numberline {27.5.2}2. Document Your Seeds}{348}{subsection.27.5.2}%
\contentsline {subsection}{\numberline {27.5.3}3. Use Different Seeds for Different Experiments}{348}{subsection.27.5.3}%
\contentsline {subsection}{\numberline {27.5.4}4. Test Robustness Across Multiple Seeds}{349}{subsection.27.5.4}%
\contentsline {section}{\numberline {27.6}What the Seed Controls}{349}{section.27.6}%
\contentsline {section}{\numberline {27.7}Common Questions}{349}{section.27.7}%
\contentsline {section}{\numberline {27.8}Summary}{350}{section.27.8}%
\contentsline {chapter}{\numberline {28}Optimizing the Aircraft Wing Weight Example}{351}{chapter.28}%
\contentsline {section}{\numberline {28.1}The AWWE Objective Function}{351}{section.28.1}%
\contentsline {section}{\numberline {28.2}Baseline Configuration}{352}{section.28.2}%
\contentsline {section}{\numberline {28.3}Optimization Setup}{353}{section.28.3}%
\contentsline {section}{\numberline {28.4}Method 1: SpotOptim (Surrogate Model Based Optimization)}{353}{section.28.4}%
\contentsline {section}{\numberline {28.5}Design Table}{354}{section.28.5}%
\contentsline {section}{\numberline {28.6}Run optimization}{354}{section.28.6}%
\contentsline {section}{\numberline {28.7}Result Table}{356}{section.28.7}%
\contentsline {section}{\numberline {28.8}Progress of the Optimization}{356}{section.28.8}%
\contentsline {section}{\numberline {28.9}Contour Plots of Most Important Hyperparameters}{357}{section.28.9}%
\contentsline {section}{\numberline {28.10}Method 2: Nelder-Mead Simplex}{360}{section.28.10}%
\contentsline {section}{\numberline {28.11}Method 3: BFGS (Quasi-Newton)}{361}{section.28.11}%
\contentsline {section}{\numberline {28.12}Comparison of Results}{362}{section.28.12}%
\contentsline {section}{\numberline {28.13}Visualization: Convergence Plots}{363}{section.28.13}%
\contentsline {subsection}{\numberline {28.13.1}SpotOptim Convergence}{363}{subsection.28.13.1}%
\contentsline {section}{\numberline {28.14}Optimal Parameter Values}{364}{section.28.14}%
\contentsline {section}{\numberline {28.15}Analysis of Optimal Solutions}{366}{section.28.15}%
\contentsline {section}{\numberline {28.16}Key Insights from Optimal Solutions}{367}{section.28.16}%
\contentsline {section}{\numberline {28.17}Method Efficiency Comparison}{368}{section.28.17}%
\contentsline {section}{\numberline {28.18}Visualization: 2D Slices of Optimal Solutions}{369}{section.28.18}%
\contentsline {section}{\numberline {28.19}Conclusion}{371}{section.28.19}%
\contentsline {section}{\numberline {28.20}Jupyter Notebook}{372}{section.28.20}%
\contentsline {chapter}{\numberline {29}Surrogate Model Selection in SpotOptim}{373}{chapter.29}%
\contentsline {section}{\numberline {29.1}Introduction}{373}{section.29.1}%
\contentsline {section}{\numberline {29.2}Setup and Imports}{374}{section.29.2}%
\contentsline {section}{\numberline {29.3}The AWWE Objective Function}{375}{section.29.3}%
\contentsline {section}{\numberline {29.4}1. Default Surrogate: Gaussian Process with Matern Kernel}{376}{section.29.4}%
\contentsline {subsection}{\numberline {29.4.1}Visualization: Default Surrogate}{377}{subsection.29.4.1}%
\contentsline {section}{\numberline {29.5}2. Gaussian Process with RBF (Radial Basis Function) Kernel}{381}{section.29.5}%
\contentsline {subsection}{\numberline {29.5.1}Visualization: RBF Kernel}{383}{subsection.29.5.1}%
\contentsline {section}{\numberline {29.6}3. Gaussian Process with Matern ν=1.5 Kernel}{386}{section.29.6}%
\contentsline {subsection}{\numberline {29.6.1}Visualization: Matern ν=1.5 Kernel}{388}{subsection.29.6.1}%
\contentsline {section}{\numberline {29.7}4. Gaussian Process with Rational Quadratic Kernel}{391}{section.29.7}%
\contentsline {subsection}{\numberline {29.7.1}Visualization: Rational Quadratic Kernel}{393}{subsection.29.7.1}%
\contentsline {section}{\numberline {29.8}5. SpotOptim Kriging Model}{396}{section.29.8}%
\contentsline {subsection}{\numberline {29.8.1}Visualization: Kriging Model}{398}{subsection.29.8.1}%
\contentsline {section}{\numberline {29.9}6. Random Forest Regressor}{401}{section.29.9}%
\contentsline {subsection}{\numberline {29.9.1}Visualization: Random Forest}{403}{subsection.29.9.1}%
\contentsline {section}{\numberline {29.10}7. XGBoost Regressor}{406}{section.29.10}%
\contentsline {section}{\numberline {29.11}8. Support Vector Regression (SVR)}{412}{section.29.11}%
\contentsline {subsection}{\numberline {29.11.1}Visualization: SVR}{414}{subsection.29.11.1}%
\contentsline {section}{\numberline {29.12}9. Gradient Boosting Regressor}{417}{section.29.12}%
\contentsline {subsection}{\numberline {29.12.1}Visualization: Gradient Boosting}{419}{subsection.29.12.1}%
\contentsline {section}{\numberline {29.13}Comprehensive Comparison}{422}{section.29.13}%
\contentsline {subsection}{\numberline {29.13.1}Visualization: Performance Comparison}{423}{subsection.29.13.1}%
\contentsline {section}{\numberline {29.14}Convergence Comparison}{425}{section.29.14}%
\contentsline {section}{\numberline {29.15}Key Insights and Recommendations}{426}{section.29.15}%
\contentsline {section}{\numberline {29.16}Summary Statistics}{428}{section.29.16}%
\contentsline {section}{\numberline {29.17}Conclusion}{430}{section.29.17}%
\contentsline {section}{\numberline {29.18}Jupyter Notebook}{430}{section.29.18}%
\contentsline {chapter}{\numberline {30}Physics-Informed Neural Networks (PINNs) Demo 1}{431}{chapter.30}%
\contentsline {chapter}{\numberline {31}Overview}{433}{chapter.31}%
\contentsline {section}{\numberline {31.1}The Differential Equation}{433}{section.31.1}%
\contentsline {chapter}{\numberline {32}Setup}{435}{chapter.32}%
\contentsline {chapter}{\numberline {33}The Neural Network}{437}{chapter.33}%
\contentsline {chapter}{\numberline {34}Generate Training Data}{439}{chapter.34}%
\contentsline {chapter}{\numberline {35}Collocation Points}{443}{chapter.35}%
\contentsline {chapter}{\numberline {36}PINN Training}{445}{chapter.36}%
\contentsline {section}{\numberline {36.1}Loss Components Explained}{445}{section.36.1}%
\contentsline {subsection}{\numberline {36.1.1}Neural Network Prediction on Data Points}{445}{subsection.36.1.1}%
\contentsline {subsection}{\numberline {36.1.2}Data Loss (Loss1)}{445}{subsection.36.1.2}%
\contentsline {subsection}{\numberline {36.1.3}Neural Network Prediction on Collocation Points}{445}{subsection.36.1.3}%
\contentsline {subsection}{\numberline {36.1.4}Computing Derivatives for the ODE}{445}{subsection.36.1.4}%
\contentsline {subsection}{\numberline {36.1.5}Physics Loss (Loss2)}{446}{subsection.36.1.5}%
\contentsline {subsection}{\numberline {36.1.6}Total Loss}{446}{subsection.36.1.6}%
\contentsline {section}{\numberline {36.2}Training Loop}{446}{section.36.2}%
\contentsline {chapter}{\numberline {37}Results Visualization}{449}{chapter.37}%
\contentsline {section}{\numberline {37.1}Training Progress}{449}{section.37.1}%
\contentsline {section}{\numberline {37.2}Solution Evolution During Training}{449}{section.37.2}%
\contentsline {section}{\numberline {37.3}Final Solution Comparison}{451}{section.37.3}%
\contentsline {section}{\numberline {37.4}Error Analysis}{452}{section.37.4}%
\contentsline {chapter}{\numberline {38}Summary}{455}{chapter.38}%
\contentsline {section}{\numberline {38.1}Key Advantages of PINNs}{455}{section.38.1}%
\contentsline {section}{\numberline {38.2}Using SpotOptim for Hyperparameter Optimization}{455}{section.38.2}%
\contentsline {chapter}{\numberline {39}Hyperparameter Tuning for Physics-Informed Neural Networks}{457}{chapter.39}%
\contentsline {chapter}{\numberline {40}Overview}{459}{chapter.40}%
\contentsline {section}{\numberline {40.1}Key Features}{459}{section.40.1}%
\contentsline {subsection}{\numberline {40.1.1}1. PyTorch Dataset and DataLoader}{459}{subsection.40.1.1}%
\contentsline {subsection}{\numberline {40.1.2}2. Automatic Transformation Handling}{460}{subsection.40.1.2}%
\contentsline {chapter}{\numberline {41}The Problem}{461}{chapter.41}%
\contentsline {chapter}{\numberline {42}Setup}{463}{chapter.42}%
\contentsline {chapter}{\numberline {43}Data Generation}{465}{chapter.43}%
\contentsline {section}{\numberline {43.1}Custom Dataset Classes}{465}{section.43.1}%
\contentsline {chapter}{\numberline {44}Define the PINN Training Function}{469}{chapter.44}%
\contentsline {chapter}{\numberline {45}Hyperparameter Optimization with SpotOptim}{473}{chapter.45}%
\contentsline {section}{\numberline {45.1}Define the Objective Function}{473}{section.45.1}%
\contentsline {section}{\numberline {45.2}Run the Optimization}{475}{section.45.2}%
\contentsline {chapter}{\numberline {46}Results Analysis}{487}{chapter.46}%
\contentsline {section}{\numberline {46.1}Best Configuration}{487}{section.46.1}%
\contentsline {subsection}{\numberline {46.1.1}Results Table with Importance Scores}{488}{subsection.46.1.1}%
\contentsline {section}{\numberline {46.2}Optimization History}{488}{section.46.2}%
\contentsline {section}{\numberline {46.3}Surrogate Visualization}{488}{section.46.3}%
\contentsline {section}{\numberline {46.4}Parameter Distribution Analysis}{489}{section.46.4}%
\contentsline {chapter}{\numberline {47}Train Final Model with Best Hyperparameters}{491}{chapter.47}%
\contentsline {chapter}{\numberline {48}Evaluate Final Model}{495}{chapter.48}%
\contentsline {chapter}{\numberline {49}Visualize Final Solution}{497}{chapter.49}%
\contentsline {chapter}{\numberline {50}Comparison with Baseline}{499}{chapter.50}%
\contentsline {chapter}{\numberline {51}Hyperparameter Sensitivity Analysis}{501}{chapter.51}%
\contentsline {section}{\numberline {51.1}Sensitivity Analysis (Spearman Correlation)}{501}{section.51.1}%
\contentsline {chapter}{\numberline {52}Summary}{503}{chapter.52}%
\contentsline {section}{\numberline {52.1}Key Findings}{503}{section.52.1}%
\contentsline {section}{\numberline {52.2}Recommendations}{504}{section.52.2}%
\contentsline {section}{\numberline {52.3}Using These Results}{505}{section.52.3}%
\contentsline {section}{\numberline {52.4}Using var\_trans for Your Hyperparameter Optimization}{506}{section.52.4}%
\contentsline {section}{\numberline {52.5}Future Directions}{506}{section.52.5}%
\contentsline {chapter}{\numberline {53}Acquisition Failure Handling in SpotOptim}{509}{chapter.53}%
\contentsline {section}{\numberline {53.1}What is Acquisition Failure?}{509}{section.53.1}%
\contentsline {section}{\numberline {53.2}Fallback Strategies}{509}{section.53.2}%
\contentsline {subsection}{\numberline {53.2.1}1. Random Space-Filling Design (Default)}{509}{subsection.53.2.1}%
\contentsline {subsection}{\numberline {53.2.2}2. Morris-Mitchell Minimizing Point}{511}{subsection.53.2.2}%
\contentsline {section}{\numberline {53.3}How It Works}{514}{section.53.3}%
\contentsline {section}{\numberline {53.4}Comparison of Strategies}{514}{section.53.4}%
\contentsline {section}{\numberline {53.5}Complete Example: Comparing Strategies}{514}{section.53.5}%
\contentsline {section}{\numberline {53.6}Advanced Usage: Setting Tolerance}{521}{section.53.6}%
\contentsline {section}{\numberline {53.7}Best Practices}{522}{section.53.7}%
\contentsline {subsection}{\numberline {53.7.1}1. Use Random for Most Problems}{522}{subsection.53.7.1}%
\contentsline {subsection}{\numberline {53.7.2}2. Use Morris-Mitchell for Intensive Sampling}{522}{subsection.53.7.2}%
\contentsline {subsection}{\numberline {53.7.3}3. Monitor Fallback Activations}{523}{subsection.53.7.3}%
\contentsline {subsection}{\numberline {53.7.4}4. Adjust Tolerance Based on Problem Scale}{523}{subsection.53.7.4}%
\contentsline {section}{\numberline {53.8}Technical Details}{524}{section.53.8}%
\contentsline {subsection}{\numberline {53.8.1}Morris-Mitchell Implementation}{524}{subsection.53.8.1}%
\contentsline {subsection}{\numberline {53.8.2}Random Strategy Implementation}{524}{subsection.53.8.2}%
\contentsline {section}{\numberline {53.9}Summary}{524}{section.53.9}%
\contentsline {chapter}{\numberline {54}Diabetes Dataset Utilities}{527}{chapter.54}%
\contentsline {section}{\numberline {54.1}Overview}{527}{section.54.1}%
\contentsline {section}{\numberline {54.2}Quick Start}{527}{section.54.2}%
\contentsline {subsection}{\numberline {54.2.1}Basic Usage}{527}{subsection.54.2.1}%
\contentsline {subsection}{\numberline {54.2.2}Training a Model}{528}{subsection.54.2.2}%
\contentsline {section}{\numberline {54.3}Function Reference}{530}{section.54.3}%
\contentsline {subsection}{\numberline {54.3.1}get\_diabetes\_dataloaders()}{530}{subsection.54.3.1}%
\contentsline {section}{\numberline {54.4}DiabetesDataset Class}{531}{section.54.4}%
\contentsline {subsection}{\numberline {54.4.1}Manual Dataset Creation}{532}{subsection.54.4.1}%
\contentsline {section}{\numberline {54.5}Advanced Usage}{533}{section.54.5}%
\contentsline {subsection}{\numberline {54.5.1}Custom Transforms}{533}{subsection.54.5.1}%
\contentsline {subsection}{\numberline {54.5.2}Different Train/Test Splits}{534}{subsection.54.5.2}%
\contentsline {subsection}{\numberline {54.5.3}Without Feature Scaling}{534}{subsection.54.5.3}%
\contentsline {subsection}{\numberline {54.5.4}Larger Batch Sizes}{535}{subsection.54.5.4}%
\contentsline {subsection}{\numberline {54.5.5}GPU Training with Pin Memory}{535}{subsection.54.5.5}%
\contentsline {section}{\numberline {54.6}Complete Training Example}{536}{section.54.6}%
\contentsline {section}{\numberline {54.7}Integration with SpotOptim}{539}{section.54.7}%
\contentsline {section}{\numberline {54.8}Best Practices}{542}{section.54.8}%
\contentsline {subsection}{\numberline {54.8.1}1. Always Use Feature Scaling}{542}{subsection.54.8.1}%
\contentsline {subsection}{\numberline {54.8.2}2. Set Random Seeds for Reproducibility}{542}{subsection.54.8.2}%
\contentsline {subsection}{\numberline {54.8.3}3. Don't Shuffle Test Data}{543}{subsection.54.8.3}%
\contentsline {subsection}{\numberline {54.8.4}4. Choose Appropriate Batch Size}{543}{subsection.54.8.4}%
\contentsline {subsection}{\numberline {54.8.5}5. Save the Scaler for Production}{543}{subsection.54.8.5}%
\contentsline {section}{\numberline {54.9}Troubleshooting}{544}{section.54.9}%
\contentsline {subsection}{\numberline {54.9.1}Issue: Out of Memory}{544}{subsection.54.9.1}%
\contentsline {subsection}{\numberline {54.9.2}Issue: Different Data Ranges}{544}{subsection.54.9.2}%
\contentsline {subsection}{\numberline {54.9.3}Issue: Non-Reproducible Results}{545}{subsection.54.9.3}%
\contentsline {subsection}{\numberline {54.9.4}Issue: Slow Data Loading}{545}{subsection.54.9.4}%
\contentsline {section}{\numberline {54.10}Summary}{545}{section.54.10}%
\contentsline {chapter}{\numberline {55}Factor Variables for Categorical Hyperparameters}{547}{chapter.55}%
\contentsline {section}{\numberline {55.1}Overview}{547}{section.55.1}%
\contentsline {section}{\numberline {55.2}Quick Start}{547}{section.55.2}%
\contentsline {subsection}{\numberline {55.2.1}Basic Factor Variable Usage}{547}{subsection.55.2.1}%
\contentsline {subsection}{\numberline {55.2.2}Neural Network Activation Function Optimization}{549}{subsection.55.2.2}%
\contentsline {section}{\numberline {55.3}Mixed Variable Types}{551}{section.55.3}%
\contentsline {subsection}{\numberline {55.3.1}Combining Factor, Integer, and Continuous Variables}{551}{subsection.55.3.1}%
\contentsline {section}{\numberline {55.4}Multiple Factor Variables}{554}{section.55.4}%
\contentsline {subsection}{\numberline {55.4.1}Optimizing Both Activation and Optimizer}{554}{subsection.55.4.1}%
\contentsline {section}{\numberline {55.5}Advanced Usage}{556}{section.55.5}%
\contentsline {subsection}{\numberline {55.5.1}Custom Categorical Choices}{556}{subsection.55.5.1}%
\contentsline {subsection}{\numberline {55.5.2}Viewing All Evaluated Configurations}{557}{subsection.55.5.2}%
\contentsline {section}{\numberline {55.6}How It Works}{560}{section.55.6}%
\contentsline {subsection}{\numberline {55.6.1}Internal Mechanism}{560}{subsection.55.6.1}%
\contentsline {subsection}{\numberline {55.6.2}Variable Type Auto-Detection}{561}{subsection.55.6.2}%
\contentsline {section}{\numberline {55.7}Complete Example: Full Workflow}{562}{section.55.7}%
\contentsline {section}{\numberline {55.8}Best Practices}{570}{section.55.8}%
\contentsline {subsection}{\numberline {55.8.1}Do's}{570}{subsection.55.8.1}%
\contentsline {subsection}{\numberline {55.8.2}Don'ts}{571}{subsection.55.8.2}%
\contentsline {section}{\numberline {55.9}Troubleshooting}{572}{section.55.9}%
\contentsline {subsection}{\numberline {55.9.1}Common Issues}{572}{subsection.55.9.1}%
\contentsline {section}{\numberline {55.10}Summary}{573}{section.55.10}%
\contentsline {section}{\numberline {55.11}See Also}{573}{section.55.11}%
\contentsline {chapter}{\numberline {56}Variable Transformations for Search Space Scaling}{575}{chapter.56}%
\contentsline {section}{\numberline {56.1}Overview}{575}{section.56.1}%
\contentsline {section}{\numberline {56.2}Why Use Transformations?}{575}{section.56.2}%
\contentsline {subsection}{\numberline {56.2.1}Problem: Poorly Scaled Search Spaces}{575}{subsection.56.2.1}%
\contentsline {subsection}{\numberline {56.2.2}Solution: Logarithmic and Other Transformations}{576}{subsection.56.2.2}%
\contentsline {section}{\numberline {56.3}Quick Start}{576}{section.56.3}%
\contentsline {subsection}{\numberline {56.3.1}Basic Log-Scale Transformation}{576}{subsection.56.3.1}%
\contentsline {section}{\numberline {56.4}Supported Transformations}{577}{section.56.4}%
\contentsline {subsection}{\numberline {56.4.1}Transformation Guidelines}{578}{subsection.56.4.1}%
\contentsline {section}{\numberline {56.5}Detailed Examples}{578}{section.56.5}%
\contentsline {subsection}{\numberline {56.5.1}Example 1: Neural Network Hyperparameter Tuning}{578}{subsection.56.5.1}%
\contentsline {subsection}{\numberline {56.5.2}Example 2: Physics-Informed Neural Networks (PINNs)}{582}{subsection.56.5.2}%
\contentsline {subsection}{\numberline {56.5.3}Example 3: Mixing Transformations}{583}{subsection.56.5.3}%
\contentsline {section}{\numberline {56.6}Viewing Transformations in Tables}{584}{section.56.6}%
\contentsline {subsection}{\numberline {56.6.1}Design Table (Before Optimization)}{584}{subsection.56.6.1}%
\contentsline {subsection}{\numberline {56.6.2}Results Table (After Optimization)}{585}{subsection.56.6.2}%
\contentsline {section}{\numberline {56.7}Internal Architecture}{585}{section.56.7}%
\contentsline {subsection}{\numberline {56.7.1}Flow Diagram}{585}{subsection.56.7.1}%
\contentsline {subsection}{\numberline {56.7.2}Key Components}{586}{subsection.56.7.2}%
\contentsline {section}{\numberline {56.8}Best Practices}{586}{section.56.8}%
\contentsline {subsection}{\numberline {56.8.1}1. Choose Appropriate Transformations}{586}{subsection.56.8.1}%
\contentsline {subsection}{\numberline {56.8.2}2. Match Transformation to Range}{587}{subsection.56.8.2}%
\contentsline {subsection}{\numberline {56.8.3}3. Validate Transformation Choice}{587}{subsection.56.8.3}%
\contentsline {subsection}{\numberline {56.8.4}4. Combine with Variable Types}{588}{subsection.56.8.4}%
\contentsline {section}{\numberline {56.9}Troubleshooting}{588}{section.56.9}%
\contentsline {subsection}{\numberline {56.9.1}Issue: Values Out of Bounds}{588}{subsection.56.9.1}%
\contentsline {subsection}{\numberline {56.9.2}Issue: Poor Optimization Performance}{588}{subsection.56.9.2}%
\contentsline {subsection}{\numberline {56.9.3}Issue: Transformation Not Applied}{589}{subsection.56.9.3}%
\contentsline {section}{\numberline {56.10}Comparison: Manual vs Automatic Transformations}{589}{section.56.10}%
\contentsline {subsection}{\numberline {56.10.1}Manual Approach (Old Way)}{589}{subsection.56.10.1}%
\contentsline {subsection}{\numberline {56.10.2}Automatic Approach (New Way)}{590}{subsection.56.10.2}%
\contentsline {section}{\numberline {56.11}Summary}{591}{section.56.11}%
\contentsline {chapter}{\numberline {57}Kriging Surrogate Integration}{593}{chapter.57}%
\contentsline {section}{\numberline {57.1}Overview}{593}{section.57.1}%
\contentsline {section}{\numberline {57.2}Module Structure}{593}{section.57.2}%
\contentsline {section}{\numberline {57.3}Kriging Class (\texttt {src/spotoptim/surrogate/kriging.py})}{593}{section.57.3}%
\contentsline {section}{\numberline {57.4}Integration with SpotOptim}{594}{section.57.4}%
\contentsline {section}{\numberline {57.5}Documentation}{594}{section.57.5}%
\contentsline {section}{\numberline {57.6}Usage Examples}{595}{section.57.6}%
\contentsline {subsection}{\numberline {57.6.1}Basic Usage}{595}{subsection.57.6.1}%
\contentsline {subsection}{\numberline {57.6.2}Custom Parameters}{595}{subsection.57.6.2}%
\contentsline {subsection}{\numberline {57.6.3}Prediction with Uncertainty}{596}{subsection.57.6.3}%
\contentsline {section}{\numberline {57.7}Technical Details}{597}{section.57.7}%
\contentsline {subsection}{\numberline {57.7.1}Kriging vs GaussianProcessRegressor}{597}{subsection.57.7.1}%
\contentsline {subsection}{\numberline {57.7.2}Algorithm}{597}{subsection.57.7.2}%
\contentsline {subsection}{\numberline {57.7.3}Key Arguments Passed from SpotOptim}{598}{subsection.57.7.3}%
\contentsline {section}{\numberline {57.8}Benefits}{598}{section.57.8}%
\contentsline {section}{\numberline {57.9}Future Enhancements}{598}{section.57.9}%
\contentsline {section}{\numberline {57.10}Conclusion}{599}{section.57.10}%
\contentsline {chapter}{\numberline {58}Learning Rate Mapping for Unified Optimizer Interface}{601}{chapter.58}%
\contentsline {section}{\numberline {58.1}Overview}{601}{section.58.1}%
\contentsline {section}{\numberline {58.2}Quick Start}{601}{section.58.2}%
\contentsline {subsection}{\numberline {58.2.1}Basic Usage}{601}{subsection.58.2.1}%
\contentsline {subsection}{\numberline {58.2.2}Scaling Learning Rates}{602}{subsection.58.2.2}%
\contentsline {subsection}{\numberline {58.2.3}Integration with LinearRegressor}{603}{subsection.58.2.3}%
\contentsline {section}{\numberline {58.3}Function Reference}{603}{section.58.3}%
\contentsline {subsection}{\numberline {58.3.1}\texttt {map\_lr(lr\_unified,\ optimizer\_name,\ use\_default\_scale=True)}}{603}{subsection.58.3.1}%
\contentsline {section}{\numberline {58.4}Supported Optimizers}{604}{section.58.4}%
\contentsline {section}{\numberline {58.5}Use Cases}{605}{section.58.5}%
\contentsline {subsection}{\numberline {58.5.1}Comparing Different Optimizers}{605}{subsection.58.5.1}%
\contentsline {subsection}{\numberline {58.5.2}Hyperparameter Optimization with SpotOptim}{606}{subsection.58.5.2}%
\contentsline {subsection}{\numberline {58.5.3}Log-Scale Hyperparameter Search}{609}{subsection.58.5.3}%
\contentsline {subsection}{\numberline {58.5.4}Custom Learning Rate Schedules}{610}{subsection.58.5.4}%
\contentsline {subsection}{\numberline {58.5.5}Direct Usage Without LinearRegressor}{610}{subsection.58.5.5}%
\contentsline {section}{\numberline {58.6}Best Practices}{611}{section.58.6}%
\contentsline {subsection}{\numberline {58.6.1}Choosing Unified Learning Rate}{611}{subsection.58.6.1}%
\contentsline {subsection}{\numberline {58.6.2}Optimizer Selection Guidelines}{612}{subsection.58.6.2}%
\contentsline {subsection}{\numberline {58.6.3}Common Patterns}{612}{subsection.58.6.3}%
\contentsline {section}{\numberline {58.7}Troubleshooting}{613}{section.58.7}%
\contentsline {subsection}{\numberline {58.7.1}Issue: Training is unstable (loss explodes)}{613}{subsection.58.7.1}%
\contentsline {subsection}{\numberline {58.7.2}Issue: Training is too slow (loss decreases very slowly)}{613}{subsection.58.7.2}%
\contentsline {subsection}{\numberline {58.7.3}Issue: Different results across optimizer runs}{613}{subsection.58.7.3}%
\contentsline {subsection}{\numberline {58.7.4}Issue: Want to use raw learning rate without mapping}{613}{subsection.58.7.4}%
\contentsline {subsection}{\numberline {58.7.5}Issue: Optimizer not supported}{613}{subsection.58.7.5}%
\contentsline {section}{\numberline {58.8}Technical Details}{614}{section.58.8}%
\contentsline {subsection}{\numberline {58.8.1}How It Works}{614}{subsection.58.8.1}%
\contentsline {subsection}{\numberline {58.8.2}Design Rationale}{614}{subsection.58.8.2}%
\contentsline {subsection}{\numberline {58.8.3}Default Learning Rates}{615}{subsection.58.8.3}%
\contentsline {section}{\numberline {58.9}Examples}{615}{section.58.9}%
\contentsline {subsection}{\numberline {58.9.1}Complete Example: Optimizer Comparison Study}{615}{subsection.58.9.1}%
\contentsline {section}{\numberline {58.10}See Also}{619}{section.58.10}%
\contentsline {section}{\numberline {58.11}References}{619}{section.58.11}%
\contentsline {chapter}{\numberline {59}Unified Learning Rate Interface in SpotOptim}{621}{chapter.59}%
\contentsline {section}{\numberline {59.1}Overview}{621}{section.59.1}%
\contentsline {section}{\numberline {59.2}Key Features}{621}{section.59.2}%
\contentsline {section}{\numberline {59.3}Usage}{622}{section.59.3}%
\contentsline {subsection}{\numberline {59.3.1}Basic Usage with LinearRegressor}{622}{subsection.59.3.1}%
\contentsline {subsection}{\numberline {59.3.2}Using Custom Unified Learning Rate}{622}{subsection.59.3.2}%
\contentsline {subsection}{\numberline {59.3.3}Direct Use of map\_lr()}{622}{subsection.59.3.3}%
\contentsline {subsection}{\numberline {59.3.4}Hyperparameter Optimization}{623}{subsection.59.3.4}%
\contentsline {section}{\numberline {59.4}Supported Optimizers}{624}{section.59.4}%
\contentsline {section}{\numberline {59.5}API Reference}{625}{section.59.5}%
\contentsline {subsection}{\numberline {59.5.1}\texttt {map\_lr(lr\_unified,\ optimizer\_name,\ use\_default\_scale=True)}}{625}{subsection.59.5.1}%
\contentsline {subsection}{\numberline {59.5.2}\texttt {LinearRegressor(...,\ lr=1.0)}}{625}{subsection.59.5.2}%
\contentsline {section}{\numberline {59.6}Design Rationale}{626}{section.59.6}%
\contentsline {subsection}{\numberline {59.6.1}Why Unified Learning Rates?}{626}{subsection.59.6.1}%
\contentsline {subsection}{\numberline {59.6.2}Comparison with spotPython}{626}{subsection.59.6.2}%
\contentsline {subsection}{\numberline {59.6.3}Log-scale Optimization}{626}{subsection.59.6.3}%
\contentsline {section}{\numberline {59.7}Examples}{627}{section.59.7}%
\contentsline {section}{\numberline {59.8}References}{627}{section.59.8}%
\contentsline {section}{\numberline {59.9}Contributing}{627}{section.59.9}%
\contentsline {section}{\numberline {59.10}License}{627}{section.59.10}%
\contentsline {chapter}{\numberline {60}Multi-Objective Optimization Support in SpotOptim}{629}{chapter.60}%
\contentsline {section}{\numberline {60.1}Overview}{629}{section.60.1}%
\contentsline {section}{\numberline {60.2}What Was Implemented}{629}{section.60.2}%
\contentsline {subsection}{\numberline {60.2.1}1. Core Functionality}{629}{subsection.60.2.1}%
\contentsline {section}{\numberline {60.3}Usage Examples}{630}{section.60.3}%
\contentsline {subsection}{\numberline {60.3.1}Example 1: Default Behavior (Use First Objective)}{630}{subsection.60.3.1}%
\contentsline {subsection}{\numberline {60.3.2}Example 2: Weighted Sum Scalarization}{630}{subsection.60.3.2}%
\contentsline {subsection}{\numberline {60.3.3}Example 3: Min-Max Scalarization}{631}{subsection.60.3.3}%
\contentsline {subsection}{\numberline {60.3.4}Example 4: Three or More Objectives}{631}{subsection.60.3.4}%
\contentsline {subsection}{\numberline {60.3.5}Example 5: With Noise Handling}{632}{subsection.60.3.5}%
\contentsline {section}{\numberline {60.4}Common Scalarization Strategies}{633}{section.60.4}%
\contentsline {subsection}{\numberline {60.4.1}1. Weighted Sum}{633}{subsection.60.4.1}%
\contentsline {subsection}{\numberline {60.4.2}2. Weighted Sum with Normalization}{633}{subsection.60.4.2}%
\contentsline {subsection}{\numberline {60.4.3}3. Min-Max (Chebyshev)}{633}{subsection.60.4.3}%
\contentsline {subsection}{\numberline {60.4.4}4. Target Achievement}{633}{subsection.60.4.4}%
\contentsline {subsection}{\numberline {60.4.5}5. Product}{633}{subsection.60.4.5}%
\contentsline {section}{\numberline {60.5}Integration with Other Features}{634}{section.60.5}%
\contentsline {section}{\numberline {60.6}Implementation Details}{634}{section.60.6}%
\contentsline {subsection}{\numberline {60.6.1}Automatic Detection}{634}{subsection.60.6.1}%
\contentsline {subsection}{\numberline {60.6.2}Data Flow}{634}{subsection.60.6.2}%
\contentsline {subsection}{\numberline {60.6.3}Backward Compatibility}{635}{subsection.60.6.3}%
\contentsline {section}{\numberline {60.7}Limitations and Notes}{635}{section.60.7}%
\contentsline {subsection}{\numberline {60.7.1}What This Is}{635}{subsection.60.7.1}%
\contentsline {subsection}{\numberline {60.7.2}What This Is Not}{635}{subsection.60.7.2}%
\contentsline {subsection}{\numberline {60.7.3}For True Multi-Objective Optimization}{635}{subsection.60.7.3}%
\contentsline {section}{\numberline {60.8}Demo Script}{635}{section.60.8}%
\contentsline {section}{\numberline {60.9}Summary}{636}{section.60.9}%
\contentsline {chapter}{\numberline {61}Surrogate Model Visualization}{637}{chapter.61}%
\contentsline {section}{\numberline {61.1}Overview}{637}{section.61.1}%
\contentsline {section}{\numberline {61.2}Features}{637}{section.61.2}%
\contentsline {section}{\numberline {61.3}Usage}{637}{section.61.3}%
\contentsline {subsection}{\numberline {61.3.1}Basic Usage}{637}{subsection.61.3.1}%
\contentsline {subsection}{\numberline {61.3.2}With Custom Parameters}{638}{subsection.61.3.2}%
\contentsline {subsection}{\numberline {61.3.3}Higher-Dimensional Problems}{638}{subsection.61.3.3}%
\contentsline {section}{\numberline {61.4}Plot Interpretation}{639}{section.61.4}%
\contentsline {subsection}{\numberline {61.4.1}Top Left: Prediction Surface}{639}{subsection.61.4.1}%
\contentsline {subsection}{\numberline {61.4.2}Top Right: Prediction Uncertainty Surface}{640}{subsection.61.4.2}%
\contentsline {subsection}{\numberline {61.4.3}Bottom Left: Prediction Contour with Points}{640}{subsection.61.4.3}%
\contentsline {subsection}{\numberline {61.4.4}Bottom Right: Uncertainty Contour with Points}{640}{subsection.61.4.4}%
\contentsline {section}{\numberline {61.5}Parameters}{640}{section.61.5}%
\contentsline {subsection}{\numberline {61.5.1}Dimension Selection}{640}{subsection.61.5.1}%
\contentsline {subsection}{\numberline {61.5.2}Appearance}{640}{subsection.61.5.2}%
\contentsline {subsection}{\numberline {61.5.3}Grid and Resolution}{640}{subsection.61.5.3}%
\contentsline {subsection}{\numberline {61.5.4}Color Scaling}{641}{subsection.61.5.4}%
\contentsline {subsection}{\numberline {61.5.5}Display}{641}{subsection.61.5.5}%
\contentsline {section}{\numberline {61.6}Examples}{641}{section.61.6}%
\contentsline {subsection}{\numberline {61.6.1}Example 1: 2D Rosenbrock Function}{641}{subsection.61.6.1}%
\contentsline {subsection}{\numberline {61.6.2}Example 2: Using Kriging Surrogate}{642}{subsection.61.6.2}%
\contentsline {subsection}{\numberline {61.6.3}Example 3: Comparing Different Dimension Pairs}{642}{subsection.61.6.3}%
\contentsline {section}{\numberline {61.7}Tips and Best Practices}{643}{section.61.7}%
\contentsline {section}{\numberline {61.8}Comparison with spotpython's plotkd()}{644}{section.61.8}%
\contentsline {subsection}{\numberline {61.8.1}Similarities}{644}{subsection.61.8.1}%
\contentsline {subsection}{\numberline {61.8.2}Differences}{644}{subsection.61.8.2}%
\contentsline {section}{\numberline {61.9}Error Handling}{644}{section.61.9}%
\contentsline {section}{\numberline {61.10}See Also}{645}{section.61.10}%
\contentsline {chapter}{\numberline {62}Point Selection Implementation in SpotOptim}{647}{chapter.62}%
\contentsline {section}{\numberline {62.1}Overview}{647}{section.62.1}%
\contentsline {section}{\numberline {62.2}Implementation Details}{647}{section.62.2}%
\contentsline {subsection}{\numberline {62.2.1}Parameters}{647}{subsection.62.2.1}%
\contentsline {subsection}{\numberline {62.2.2}Methods}{647}{subsection.62.2.2}%
\contentsline {section}{\numberline {62.3}Key Differences from spotpython}{648}{section.62.3}%
\contentsline {section}{\numberline {62.4}Example Usage}{648}{section.62.4}%
\contentsline {section}{\numberline {62.5}Benefits}{650}{section.62.5}%
\contentsline {section}{\numberline {62.6}Comparison with spotpython}{650}{section.62.6}%
\contentsline {section}{\numberline {62.7}References}{650}{section.62.7}%
\contentsline {chapter}{\numberline {63}Save and Load in SpotOptim}{651}{chapter.63}%
\contentsline {section}{\numberline {63.1}Key Concepts}{651}{section.63.1}%
\contentsline {subsection}{\numberline {63.1.1}Experiments vs Results}{651}{subsection.63.1.1}%
\contentsline {subsection}{\numberline {63.1.2}What Gets Saved}{651}{subsection.63.1.2}%
\contentsline {section}{\numberline {63.2}Quick Start}{652}{section.63.2}%
\contentsline {subsection}{\numberline {63.2.1}Basic Save and Load}{652}{subsection.63.2.1}%
\contentsline {section}{\numberline {63.3}Distributed Workflow}{653}{section.63.3}%
\contentsline {subsection}{\numberline {63.3.1}Step 1: Define Experiment Locally}{653}{subsection.63.3.1}%
\contentsline {subsection}{\numberline {63.3.2}Step 2: Execute on Remote Machine}{653}{subsection.63.3.2}%
\contentsline {subsection}{\numberline {63.3.3}Step 3: Analyze Results Locally}{655}{subsection.63.3.3}%
\contentsline {section}{\numberline {63.4}Advanced Usage}{656}{section.63.4}%
\contentsline {subsection}{\numberline {63.4.1}Custom Filenames and Paths}{656}{subsection.63.4.1}%
\contentsline {subsection}{\numberline {63.4.2}Overwrite Protection}{657}{subsection.63.4.2}%
\contentsline {subsection}{\numberline {63.4.3}Loading and Continuing Optimization}{657}{subsection.63.4.3}%
\contentsline {section}{\numberline {63.5}Working with Noisy Functions}{658}{section.63.5}%
\contentsline {section}{\numberline {63.6}Working with Different Variable Types}{659}{section.63.6}%
\contentsline {section}{\numberline {63.7}Best Practices}{661}{section.63.7}%
\contentsline {subsection}{\numberline {63.7.1}1. Always Re-attach the Objective Function}{661}{subsection.63.7.1}%
\contentsline {subsection}{\numberline {63.7.2}2. Use Meaningful Prefixes}{661}{subsection.63.7.2}%
\contentsline {subsection}{\numberline {63.7.3}3. Save Experiments Before Remote Execution}{661}{subsection.63.7.3}%
\contentsline {subsection}{\numberline {63.7.4}4. Version Your Experiments}{662}{subsection.63.7.4}%
\contentsline {subsection}{\numberline {63.7.5}5. Handle File Paths Robustly}{662}{subsection.63.7.5}%
\contentsline {section}{\numberline {63.8}Complete Example: Multi-Machine Workflow}{662}{section.63.8}%
\contentsline {subsection}{\numberline {63.8.1}Local Machine (Setup)}{662}{subsection.63.8.1}%
\contentsline {subsection}{\numberline {63.8.2}Remote Machine (Execution)}{664}{subsection.63.8.2}%
\contentsline {subsection}{\numberline {63.8.3}Local Machine (Analysis)}{665}{subsection.63.8.3}%
\contentsline {section}{\numberline {63.9}Technical Details}{667}{section.63.9}%
\contentsline {subsection}{\numberline {63.9.1}Serialization Method}{667}{subsection.63.9.1}%
\contentsline {subsection}{\numberline {63.9.2}Component Reinitialization}{667}{subsection.63.9.2}%
\contentsline {subsection}{\numberline {63.9.3}Excluded Components}{667}{subsection.63.9.3}%
\contentsline {subsection}{\numberline {63.9.4}File Format}{668}{subsection.63.9.4}%
\contentsline {section}{\numberline {63.10}Troubleshooting}{668}{section.63.10}%
\contentsline {subsection}{\numberline {63.10.1}Issue: ``AttributeError: `SpotOptim' object has no attribute `fun'\,''}{668}{subsection.63.10.1}%
\contentsline {subsection}{\numberline {63.10.2}Issue: ``FileNotFoundError: Experiment file not found''}{668}{subsection.63.10.2}%
\contentsline {subsection}{\numberline {63.10.3}Issue: ``FileExistsError: File already exists''}{668}{subsection.63.10.3}%
\contentsline {subsection}{\numberline {63.10.4}Issue: Results differ after loading}{669}{subsection.63.10.4}%
\contentsline {section}{\numberline {63.11}See Also}{669}{section.63.11}%
\contentsline {chapter}{\numberline {64}Success Rate Tracking in SpotOptim}{671}{chapter.64}%
\contentsline {section}{\numberline {64.1}What is Success Rate?}{671}{section.64.1}%
\contentsline {section}{\numberline {64.2}First Example}{671}{section.64.2}%
\contentsline {section}{\numberline {64.3}Second Example}{672}{section.64.3}%
\contentsline {section}{\numberline {64.4}Accessing Success Rate}{673}{section.64.4}%
\contentsline {section}{\numberline {64.5}Interpreting Success Rate}{674}{section.64.5}%
\contentsline {subsection}{\numberline {64.5.1}High Success Rate (\textgreater {} 0.5)}{674}{subsection.64.5.1}%
\contentsline {subsection}{\numberline {64.5.2}Medium Success Rate (0.2 - 0.5)}{674}{subsection.64.5.2}%
\contentsline {subsection}{\numberline {64.5.3}Low Success Rate (\textless {} 0.2)}{675}{subsection.64.5.3}%
\contentsline {section}{\numberline {64.6}TensorBoard Visualization}{675}{section.64.6}%
\contentsline {section}{\numberline {64.7}Example: Comparing Multiple Runs}{675}{section.64.7}%
\contentsline {section}{\numberline {64.8}Success Rate with Noisy Functions}{677}{section.64.8}%
\contentsline {section}{\numberline {64.9}Advanced: Custom Window Size}{678}{section.64.9}%
\contentsline {section}{\numberline {64.10}Best Practices}{679}{section.64.10}%
\contentsline {subsection}{\numberline {64.10.1}1. Monitor During Long Runs}{679}{subsection.64.10.1}%
\contentsline {subsection}{\numberline {64.10.2}2. Combine with TensorBoard}{679}{subsection.64.10.2}%
\contentsline {subsection}{\numberline {64.10.3}3. Use as Stopping Criterion}{679}{subsection.64.10.3}%
\contentsline {subsection}{\numberline {64.10.4}4. Compare Different Strategies}{680}{subsection.64.10.4}%
\contentsline {section}{\numberline {64.11}Technical Details}{680}{section.64.11}%
\contentsline {subsection}{\numberline {64.11.1}How Success is Counted}{680}{subsection.64.11.1}%
\contentsline {subsection}{\numberline {64.11.2}Rolling Window Calculation}{680}{subsection.64.11.2}%
\contentsline {subsection}{\numberline {64.11.3}Update Frequency}{680}{subsection.64.11.3}%
\contentsline {section}{\numberline {64.12}Summary}{681}{section.64.12}%
\contentsline {chapter}{\numberline {65}TensorBoard Log Cleaning Feature in SpotOptim}{683}{chapter.65}%
\contentsline {section}{\numberline {65.1}Usage}{683}{section.65.1}%
\contentsline {subsection}{\numberline {65.1.1}Basic Usage}{683}{subsection.65.1.1}%
\contentsline {subsection}{\numberline {65.1.2}Use Cases}{684}{subsection.65.1.2}%
\contentsline {section}{\numberline {65.2}Implementation Details}{684}{section.65.2}%
\contentsline {subsection}{\numberline {65.2.1}Cleaning Method}{684}{subsection.65.2.1}%
\contentsline {subsection}{\numberline {65.2.2}Execution Flow}{685}{subsection.65.2.2}%
\contentsline {section}{\numberline {65.3}Safety Features}{685}{section.65.3}%
\contentsline {section}{\numberline {65.4}Warning}{685}{section.65.4}%
\contentsline {chapter}{\numberline {66}TensorBoard Logging in SpotOptim}{687}{chapter.66}%
\contentsline {section}{\numberline {66.1}Quick Start}{687}{section.66.1}%
\contentsline {subsection}{\numberline {66.1.1}1. Enable TensorBoard Logging}{687}{subsection.66.1.1}%
\contentsline {subsection}{\numberline {66.1.2}2. View Logs in TensorBoard}{688}{subsection.66.1.2}%
\contentsline {section}{\numberline {66.2}Cleaning Old Logs}{688}{section.66.2}%
\contentsline {subsection}{\numberline {66.2.1}Use Cases}{689}{subsection.66.2.1}%
\contentsline {section}{\numberline {66.3}Custom Log Directory}{689}{section.66.3}%
\contentsline {section}{\numberline {66.4}What Gets Logged}{689}{section.66.4}%
\contentsline {subsection}{\numberline {66.4.1}Scalar Metrics}{689}{subsection.66.4.1}%
\contentsline {subsection}{\numberline {66.4.2}Hyperparameters}{690}{subsection.66.4.2}%
\contentsline {section}{\numberline {66.5}Examples}{690}{section.66.5}%
\contentsline {subsection}{\numberline {66.5.1}Basic Usage}{690}{subsection.66.5.1}%
\contentsline {subsection}{\numberline {66.5.2}Noisy Optimization}{691}{subsection.66.5.2}%
\contentsline {subsection}{\numberline {66.5.3}With OCBA}{691}{subsection.66.5.3}%
\contentsline {section}{\numberline {66.6}Comparing Multiple Runs}{692}{section.66.6}%
\contentsline {section}{\numberline {66.7}TensorBoard Features}{693}{section.66.7}%
\contentsline {subsection}{\numberline {66.7.1}SCALARS Tab}{693}{subsection.66.7.1}%
\contentsline {subsection}{\numberline {66.7.2}HPARAMS Tab}{693}{subsection.66.7.2}%
\contentsline {subsection}{\numberline {66.7.3}Text Tab}{693}{subsection.66.7.3}%
\contentsline {section}{\numberline {66.8}Tips}{693}{section.66.8}%
\contentsline {section}{\numberline {66.9}Demo Scripts}{694}{section.66.9}%
\contentsline {section}{\numberline {66.10}Troubleshooting}{694}{section.66.10}%
\contentsline {section}{\numberline {66.11}Related Parameters}{695}{section.66.11}%
\contentsline {section}{\numberline {66.12}Performance Notes}{695}{section.66.12}%
\contentsline {chapter}{\numberline {67}Variable Type (var\_type) Implementation in SpotOptim}{697}{chapter.67}%
\contentsline {section}{\numberline {67.1}Overview}{697}{section.67.1}%
\contentsline {section}{\numberline {67.2}Supported Variable Types}{697}{section.67.2}%
\contentsline {subsection}{\numberline {67.2.1}1. \textbf {`float'}}{697}{subsection.67.2.1}%
\contentsline {subsection}{\numberline {67.2.2}2. \textbf {`int'}}{697}{subsection.67.2.2}%
\contentsline {subsection}{\numberline {67.2.3}3. \textbf {`factor'}}{697}{subsection.67.2.3}%
\contentsline {section}{\numberline {67.3}Implementation Details}{698}{section.67.3}%
\contentsline {subsection}{\numberline {67.3.1}Where \texttt {var\_type} is Used}{698}{subsection.67.3.1}%
\contentsline {subsection}{\numberline {67.3.2}Core Method: \texttt {\_repair\_non\_numeric()}}{698}{subsection.67.3.2}%
\contentsline {section}{\numberline {67.4}Example Usage}{699}{section.67.4}%
\contentsline {subsection}{\numberline {67.4.1}Example 1: All Float Variables (Default)}{699}{subsection.67.4.1}%
\contentsline {subsection}{\numberline {67.4.2}Example 2: Pure Integer Optimization}{699}{subsection.67.4.2}%
\contentsline {subsection}{\numberline {67.4.3}Example 3: Categorical (Factor) Variables}{700}{subsection.67.4.3}%
\contentsline {subsection}{\numberline {67.4.4}Example 4: Mixed Variable Types}{701}{subsection.67.4.4}%
\contentsline {section}{\numberline {67.5}Key Findings}{702}{section.67.5}%
\contentsline {section}{\numberline {67.6}Recommendations}{702}{section.67.6}%
\contentsline {section}{\numberline {67.7}Future Enhancements (Optional)}{702}{section.67.7}%
\contentsline {chapter}{References}{703}{chapter*.130}%
\providecommand \tocbasic@end@toc@file {}\tocbasic@end@toc@file 
